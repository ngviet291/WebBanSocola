<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Giỏ Hàng</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
  <style>
    body {
      background-color: #f8f9fa;
      flex-direction: column;
      font-family: 'Times New Roman', Times, serif;
    }

    .navbar-nav .nav-link {
      margin-left: 15px;
      margin-right: 15px;
      color: black;
    }

    .nav-link.active {
      text-decoration: underline;
      color: #c23e2e !important;
    }

    .d-flex {
      gap: 20px;
    }

    .d-flex a:hover {
      color: orange;
    }

    .navbar-nav .nav-link:hover {
      color: orange;
    }
    .cart{
      background-color: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    .card-title {
      background-color: #f4e3c1;
      padding: 30px;
      text-align: center;
      color: #4f2b3d;
    }

    .cart-item img {
      width: 100px;
      height: 100px;
      object-fit: cover;
    }

    .cart-item {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }

    .cart-item .product-info {
      flex: 1;
      margin-left: 20px;
    }

    .cart-item .product-info h5 {
      margin: 0;
      font-size: 18px;
    }

    .total-price {
      margin-top: 15px;
      margin-left: 10px;
    }

    .info-section {
      background-color: #f4e3c1 !important;
      padding-top: 30px;
      padding-bottom: 10px;
    }

    section h2 {
      font-size: 36px;
      color: #3e2b2b;
      font-weight: bold;
    }

    .info-section h3 {
      font-size: 18px;
      color: #3e2b2b;
      font-weight: bold;
    }

    .info-section p {
      font-size: 15px;
      color: #555;
    }

    .info-section a {
      color: #3e2b2b;
      text-decoration: none;
      font-weight: bold;
    }

    .info-section a:hover {
      text-decoration: underline;
    }

    .info-content {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      gap: 30px;
    }

    .info-box {
      flex: 1;
    }

    .info-box h3 {
      margin-bottom: 10px;
    }

    .info-box p {
      margin-bottom: 15px;
    }

    .text-brown {
      color: #6f4f28;
    }

    .text-brown:hover {
      color: black !important;
    }

    .description-section h3 {
      font-size: 36px;
      color: #3e2b2b;
      font-weight: bold;
    }

    .description-section p {
      font-size: 20px;
      color: #555;
      margin-top: 10px;
    }

    .description-section .d-flex {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 30px;
    }

    .description-section .d-flex img {
      max-width: 100%;
      height: auto;
    }

    .description-section .d-flex div {
      flex: 1;
    }

    .map iframe {
      border-radius: 10px;
    }
    #toggleInfoButton {
      display: none;
      margin: 20px auto;
      background-color: #633d1e;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    @media (max-width:500px) {
      .info-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 30px;
        padding: 0 20px;
      }

      .nav-link i {
        margin-left: 30px;
      }
      .info-box {
        display: none;
      }

      .info-box.visible {
        display: block;
      }

      #toggleInfoButton {
        display: block;
      }
      .map {
        width: 100% !important;
        margin: 0 auto;
      }

      .map iframe {
        height: 200px;
      }

    }

    .footer {
      background-color: #3e2b2b;
      color: white;
      padding: 1rem 0;
      text-align: center;
      margin-top: auto;
    }

    .btn-small {
      font-size: 14px;
      padding: 10px 20px;
      width: auto;
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg navbar-light bg-light sticky-top">
    <a class="navbar-brand d-flex align-items-center w-25" href="../HTML/home.html">
      <img class="ms-5 w-25" src="../IMG/logo-removebg-preview.png" alt="Logo">
      <span>FEAT CHOCOLATE</span>
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
      <ul class="navbar-nav">
        <div class="navbar-nav d-flex justify-content-center">
          <li class="nav-item"><a class="nav-link" href="../HTML/home.html">Trang chủ</a></li>
          <li class="nav-item"><a class="nav-link" href="../HTML/product.html">Sản phẩm</a></li>
          <li class="nav-item"><a class="nav-link" href="../HTML/introduction.html">Giới thiệu</a></li>
          <li class="nav-item"><a class="nav-link" href="../HTML/contact.html">Liên hệ</a></li>
        </div>
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown"
            aria-expanded="false">
            Chính sách và Điều khoản
          </a>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
            <li><a class="dropdown-item" href="../HTML/policy.html">Chính sách</a></li>
            <li><a class="dropdown-item" href="../HTML/terms.html">Điều khoản</a></li>
          </ul>
        </li>
      </ul>
    </div>
    <div class="d-flex me-lg-5">
      <div class="position-relative">
        <a class="nav-link" href="#" id="toggleSearch"><i class="bi bi-search"></i></a>
        <div id="searchDropdown" class="d-none position-absolute bg-white p-2 shadow rounded"
          style="top: 100%; right: 0; z-index: 1000; width: 250px;">
          <input type="text" id="searchBox" class="form-control" placeholder="Tìm sản phẩm...">
        </div>
      </div>
      <a class="nav-link" href="../HTML/personal.html" id="personalLink" style="display: block;">
        <i class="bi bi-person"></i>
      </a>
      <a class="nav-link active" href="../HTML/cart.html"><i class="bi bi-cart"></i></a>
      <a class="nav-link" href="#" id="loginSignupLink" style="display: block;"
        onclick="window.location.href = '../HTML/loginandres.html';"><i class="bi bi-box-arrow-in-right"></i> Đăng nhập
        / Đăng ký</a>
    </div>
  </nav>
  <div class="container cart">
    <div class="card-title">
      <h2>Giỏ hàng của bạn</h2>
    </div>
    <!-- Bảng giỏ hàng -->
    <table id="cart-table" class="table table-bordered mt-5 mb-5">
      <thead>
        <tr>
          <th class="text-center" style="font-size: 18px;">Số thứ tự</th>
          <th class="text-center" style="font-size: 18px;">Hình ảnh</th>
          <th class="text-center" style="font-size: 18px;">Tên sản phẩm</th>
          <th class="text-center" style="font-size: 18px;">Số lượng</th>
          <th class="text-center" style="font-size: 18px;">Giá tiền</th>
          <th class="text-center" style="font-size: 18px;">Thao tác</th>
        </tr>
      </thead>
      <tbody id="cart-items-container">
      </tbody>
      <tfoot>
        <tr>
          <td colspan="3" class="text-center fw-bold" style="font-size: 25px;">Tổng tiền:</td>
          <td colspan="2" class="text-center fw-bold" id="totalAmount" style="font-size: 25px;"></td>
          <td>
            <button class="btn btn-success w-75" style="margin-left: 30px;" data-bs-toggle="modal"
              data-bs-target="#checkoutModal">
              Thanh toán
            </button>
          </td>
        </tr>
        <tr>
          <td colspan="6" class="text-center">
            <button class="btn btn-danger" id="clearCartBtn">Làm sạch giỏ hàng</button>
          </td>
        </tr>
      </tfoot>
    </table>
    <div id="emptyCartMessage" class="text-center d-none mt-5">
      <p>Giỏ hàng của bạn hiện đang trống.</p>
      <a href="../HTML/product.html" class="btn btn-primary mt-5">Mua ngay</a>
    </div>
    <div id="orderHistoryView" class="mt-5 text-center">
      <p>Xem lịch sử đơn hàng tại <a href="personal.html#orderHistory">đây !</a> </p>
    </div>

    <div class="row mt-4" id="checkoutRow">
      <div class="col-12">

      </div>
    </div>
    <section class="info-section mt-5">
      <div class="info-content p-md-2">
        <div class="info-box">
          <h2>FEAT Chocolate</h2>
          <p>Chúng tôi mời bạn đến khám phá và trải nghiệm hương vị hạnh phúc, nơi niềm vui và chất lượng hòa quyện
            trong từng viên socola. Từ vị đắng nhẹ đến sự ngọt ngào quyến rũ, mỗi miếng socola sẽ dẫn dắt bạn vào hành
            trình cảm xúc đặc biệt và đáng nhớ.</p>
        </div>
        <div class="info-box">
          <h3>Thông tin liên hệ</h3>
          <p>Địa chỉ: Số 12 Nguyễn Văn Bảo, Phường 1, Quận Gò Vấp, Thành phố Hồ Chí Minh</p>
          <p>Email: vietnguyen29105@feat-chocolate.com</p>
          <p>Số điện thoại: 0123 456 789</p>
          <a href="#">Liên hệ với chúng tôi</a>
        </div>
        <div class="info-box">
          <h3>Chính sách và Điều khoản</h3>
          <p><a href="#">Chính sách bảo mật</a></p>
          <p><a href="#">Chính sách đổi trả</a></p>
          <p><a href="#">Điều khoản sử dụng</a></p>
        </div>
        <div class="info-box">
          <h3>Địa chỉ</h3>
          <div class="map" style="height: 300px; width: 90%; margin-top: 20px; margin-right: 10px;">
            <iframe
              src="https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d3918.872745742136!2d106.68414867504248!3d10.821049239330454!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2s!4v1744343689231!5m2!1sen!2s"
              width="100%" height="200px" style="border:0;" allowfullscreen="" loading="lazy"
              referrerpolicy="no-referrer-when-downgrade">
            </iframe>
            <p style="font-size: 8.8px; margin-top: 40px;">Số 12 Nguyễn Văn Bảo, Phường 1, Quận Gò Vấp, Thành phố Hồ Chí
              Minh</p>
          </div>
        </div>
        <button id="toggleInfoButton">Xem thêm</button>
      </div>
    </section>
  </div>
  <div class="modal fade" id="checkoutModal" tabindex="-1" aria-labelledby="checkoutModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="checkoutModalLabel">Thanh toán</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p id="modalTotalAmount">Tổng tiền: 0 VND</p>
          <form id="checkoutForm">
            <div class="mb-3">
              <label for="checkoutName" class="form-label">Họ và tên</label>
              <input type="text" class="form-control" id="checkoutName" required>
            </div>
            <div class="mb-3">
              <label for="checkoutEmail" class="form-label">Email</label>
              <input type="email" class="form-control" id="checkoutEmail" required>
            </div>
            <div class="mb-3">
              <label for="checkoutPhone" class="form-label">Số điện thoại</label>
              <input type="tel" class="form-control" id="checkoutPhone" required>
            </div>
            <button type="submit" class="btn btn-primary">Xác nhận thanh toán</button>
          </form>
        </div>
      </div>
    </div>
  </div>
  <footer class="footer text-center">
    <p>&copy; 2025 FEAT Chocolate. All rights reserved.</p>
  </footer>
  <script>
    function renderCart() {
      const cart = JSON.parse(localStorage.getItem('cart')) || [];
      const cartContainer = document.getElementById('cart-items-container');
      const totalAmount = document.getElementById('totalAmount');
      const checkoutRow = document.getElementById('checkoutRow');
      const emptyCartMessage = document.getElementById('emptyCartMessage');

      cartContainer.innerHTML = '';

      if (cart.length === 0) {
        emptyCartMessage.classList.remove('d-none');
        checkoutRow.classList.add('d-none');
        totalAmount.textContent = '0 VND';
        document.getElementById('modalTotalAmount').textContent = 'Tổng tiền: 0 VND';
        document.getElementById('cart-table').classList.add('d-none');
        return;
      }

      emptyCartMessage.classList.add('d-none');
      checkoutRow.classList.remove('d-none');
      document.getElementById('cart-table').classList.remove('d-none');

      let totalPrice = 0;

      cart.forEach((item, index) => {
        const itemTotal = item.price * item.quantity;
        totalPrice += itemTotal;

        const row = document.createElement('tr');
        row.classList.add('align-middle', 'text-center');
        row.innerHTML = `
      <td>${index + 1}</td>
      <td>
        <img src="${item.image}" alt="${item.name}" class="img-fluid rounded" 
             style="width: 140px; height: 100px; object-fit: cover;">
      </td>
      <td style="font-size: 1.1rem; font-weight: 500;">${item.name}</td>
      <td>
        <input type="number" class="form-control quantity-input mx-auto" 
               style="max-width: 80px;" value="${item.quantity}" min="1" max="10" 
               data-index="${index}">
      </td>
      <td class="text-primary fw-bold">${itemTotal.toLocaleString()} VND</td>
      <td>
        <button class="btn btn-danger btn-sm btn-delete" data-index="${index}">Xóa</button>
      </td>
    `;
        cartContainer.appendChild(row);
      });

      totalAmount.textContent = `${totalPrice.toLocaleString()} VND`;
      document.getElementById('modalTotalAmount').textContent = `Tổng tiền: ${totalPrice.toLocaleString()} VND`;

      document.querySelectorAll('.btn-delete').forEach(btn => {
        btn.addEventListener('click', function () {
          const index = this.getAttribute('data-index');
          const confirmed = confirm("Bạn có chắc muốn xóa sản phẩm này khỏi giỏ hàng?");
          if (confirmed) {
            cart.splice(index, 1);
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCart();
          }
        });
      });


      document.querySelectorAll('.quantity-input').forEach(input => {
        input.addEventListener('change', function () {
          const index = this.getAttribute('data-index');
          const newQty = parseInt(this.value);
          if (newQty >= 1 && newQty <= 10) {
            cart[index].quantity = newQty;
            localStorage.setItem('cart', JSON.stringify(cart));
            renderCart();
          }
        });
      });
    }

    document.getElementById('clearCartBtn').addEventListener('click', function () {
      if (confirm("Bạn có chắc muốn xóa toàn bộ giỏ hàng?")) {
        localStorage.removeItem('cart');
        renderCart();
      }
    });
    function saveOrderHistory(orderDetails) {
      const orderHistory = JSON.parse(localStorage.getItem('orderHistory')) || [];
      orderHistory.push(orderDetails);
      localStorage.setItem('orderHistory', JSON.stringify(orderHistory));
    }

    const checkoutForm = document.getElementById('checkoutForm');
    checkoutForm.addEventListener('submit', (e) => {
      e.preventDefault();
      const cart = JSON.parse(localStorage.getItem('cart')) || [];

      if (cart.length === 0) {
        alert("Giỏ hàng của bạn hiện tại trống. Vui lòng thêm sản phẩm vào giỏ.");
        return;
      }
      const customerName = document.getElementById('checkoutName').value;
      const customerEmail = document.getElementById('checkoutEmail').value;
      const customerPhone = document.getElementById('checkoutPhone').value;
      let totalAmount = 0;
      cart.forEach(item => {
        totalAmount += item.price * item.quantity;
      });
      const orderDetails = {
        customerName,
        customerEmail,
        customerPhone,
        items: cart,
        totalAmount,
        date: new Date().toLocaleString()
      };
      saveOrderHistory(orderDetails);
      alert("Cảm ơn bạn đã đặt hàng! Chúng tôi sẽ liên hệ với bạn sớm.");
      localStorage.removeItem('cart');
      renderCart();
      const modal = bootstrap.Modal.getInstance(document.getElementById('checkoutModal'));
      modal.hide();
      checkoutForm.reset();
    });
    document.addEventListener('DOMContentLoaded', renderCart);
    const toggleButton = document.getElementById("toggleInfoButton");
    const infoBoxes = document.querySelectorAll(".info-box");
    let isExpanded = false;

    // Khi bấm nút
    toggleButton.addEventListener("click", function () {
      isExpanded = !isExpanded;

      infoBoxes.forEach((box, index) => {
        if (isExpanded) {
          box.classList.add("visible");
        } else {
          // Chỉ hiển thị box đầu tiên
          if (index === 0) {
            box.classList.add("visible");
          } else {
            box.classList.remove("visible");
          }
        }
      });

      toggleButton.textContent = isExpanded ? "Thu gọn" : "Xem thêm";
    });

    // Khi load trang nếu nhỏ hơn 500px, chỉ hiện box đầu
    window.addEventListener("load", () => {
      if (window.innerWidth <= 500) {
        infoBoxes.forEach((box, index) => {
          if (index === 0) {
            box.classList.add("visible");
          }
        });
      }
    });
  </script>
</body>

</html>